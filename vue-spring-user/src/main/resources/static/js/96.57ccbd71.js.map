{"version":3,"file":"js/96.57ccbd71.js","mappings":"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","sources":["webpack://frontend/./src/api/board/galleryService.js","webpack://frontend/./src/views/board/gallery/GalleryUpdate.vue","webpack://frontend/./src/views/board/gallery/GalleryUpdate.vue?a139"],"sourcesContent":["import axios from \"@/api/config/axios\";\r\nimport {MULTIPART_CONFIG} from \"@/constants\";\r\n\r\n/**\r\n * 갤러리를 등록합니다.\r\n * @param formData 등록 폼\r\n * @return {Promise<number>} 등록된 게시글 번호를 반환하거나,\r\n * data: 에러필드에 에러메시지가 담겨진 객체를 반환합니다.\r\n * message: API 통신 에러메시지\r\n */\r\nexport function registerGallery (formData) {\r\n  return axios.post('/api/galleries', formData, MULTIPART_CONFIG)\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorFields, errorMessage}}}) => {\r\n        throw {\r\n          data: errorFields,\r\n          message: errorMessage,\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 갤러리 목록을 조회합니다.\r\n * @param condition 검색조건\r\n * @returns {Promise<Array>} 갤러리 목록이 배열로 반환됩니다.\r\n */\r\nexport function getGalleryList(condition) {\r\n  return axios.get('/api/galleries', {\r\n    params: condition\r\n  })\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 갤러리 상세정보를 조회합니다.\r\n * @param boardId 갤러리 번호\r\n * @return\r\n */\r\nexport function getGalleryDetail(boardId) {\r\n  return axios.get(`/api/galleries/${boardId}`)\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 갤러리를 업데이트합니다.\r\n * @param boardId 갤러리 번호\r\n * @param formData 업데이트폼 정보\r\n * @return {Promise<number>} 갤러리 번호\r\n */\r\nexport function updateGallery(boardId, formData) {\r\n  return axios.put(`/api/galleries/${boardId}`, formData, MULTIPART_CONFIG)\r\n      .then(() => {\r\n        return boardId;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 갤러리를 삭제합니다.\r\n * @param boardId 갤러리 번호\r\n * @return {Promise<void>}\r\n */\r\nexport function deleteGallery(boardId) {\r\n  return axios.delete(`/api/galleries/${boardId}`)\r\n      .then(() => {\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        };\r\n      });\r\n}","<template>\r\n\r\n  <GNB></GNB>\r\n\r\n  <!-- 타이틀 -->\r\n  <board-title title=\"갤러리\"></board-title>\r\n\r\n  <div class=\"update-container\">\r\n\r\n    <!-- 게시글 카테고리 -->\r\n    <div class=\"update-category-container\">\r\n\r\n      <board-form-title name=\"분류\" class=\"board-form-title-category\"></board-form-title>\r\n\r\n      <div class=\"update-category-input-container\">\r\n        <category-select\r\n            v-model=\"updateForm.categoryId\"\r\n            @change=\"errorFields.categoryId = validateCategory(updateForm.categoryId)\"\r\n            :category-list=\"categoryList\"\r\n            class=\"update-category\">\r\n        </category-select>\r\n        <input-error :error-msg=\"errorFields.categoryId\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 게시글 제목 -->\r\n    <div class=\"update-title-container\">\r\n\r\n      <board-form-title name=\"제목\" class=\"board-form-title-title\"></board-form-title>\r\n\r\n      <div class=\"update-title-input-container\">\r\n        <base-input\r\n            v-model=\"updateForm.boardTitle\"\r\n            @change=\"errorFields.boardTitle = validateTitle(updateForm.boardTitle)\"\r\n            placeholder=\"제목을 입력해 주세요.\"\r\n            class=\"update-title\">\r\n        </base-input>\r\n        <input-error :error-msg=\"errorFields.boardTitle\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 게시글 내용 -->\r\n    <div class=\"update-content-container\">\r\n\r\n      <board-form-title name=\"내용\" class=\"board-form-title-content\"></board-form-title>\r\n\r\n      <div class=\"update-content-input-container\">\r\n        <base-textarea\r\n            v-model=\"updateForm.boardContent\"\r\n            @change=\"errorFields.boardContent = validateTitle(updateForm.boardContent)\"\r\n            class=\"update-content\">\r\n        </base-textarea>\r\n        <input-error :error-msg=\"errorFields.boardContent\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 첨부 파일 -->\r\n    <div class=\"update-file-container\">\r\n\r\n      <board-form-title\r\n          :required=\"false\"\r\n          name=\"첨부\"\r\n          class=\"board-form-title-file\">\r\n      </board-form-title>\r\n\r\n      <div class=\"update-file-input-container\">\r\n        <board-file-list\r\n            @upload-file=\"onUploadFile\"\r\n            @delete-file=\"onDeleteFile\"\r\n            :is-update=\"true\"\r\n            :file-list=\"fileList\"></board-file-list>\r\n        <input-error :error-msg=\"errorFields.saveFiles\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 수정 폼 버튼 -->\r\n    <board-form-btn-container\r\n        @update=\"onUpdate\"\r\n        @cancel=\"router.push({path: '/galleries', query: condition});\"\r\n        form-type=\"update\">\r\n    </board-form-btn-container>\r\n\r\n  </div>\r\n</template>\r\n<script setup>\r\n/**\r\n * 갤러리 수정 폼 컴포넌트\r\n */\r\n\r\nimport BoardTitle from \"@/components/board/BoardTitle.vue\";\r\nimport BoardFormTitle from \"@/components/board/BoardFormTitle.vue\";\r\nimport {ref} from \"vue\";\r\nimport CategorySelect from \"@/components/CategorySelect.vue\";\r\nimport InputError from \"@/components/base/BaseInputError.vue\";\r\nimport BaseInput from \"@/components/base/BaseInput.vue\";\r\nimport {validateCategory, validateContent, validateTitle} from \"@/util/boardValidUtil\";\r\nimport BaseTextarea from \"@/components/base/BaseTextarea.vue\";\r\nimport BoardFileList from \"@/components/board/BoardFileList.vue\";\r\nimport {useRoute, useRouter} from \"vue-router\";\r\nimport {GALLERY_CATEGORY_ID} from \"@/constants\";\r\nimport {getCategoryList} from \"@/api/categoryService\";\r\nimport {useStore} from \"vuex\";\r\nimport {getGalleryDetail, updateGallery} from \"@/api/board/galleryService\";\r\nimport {isCurrentUserId} from \"@/util/authUtil\";\r\nimport GNB from \"@/components/GNB.vue\";\r\nimport BoardFormBtnContainer from \"@/components/board/BoardFormBtnContainer.vue\";\r\nimport {createFormData, initFormValue} from \"@/util/boardUtil\";\r\nimport {createCondition} from \"@/util/queryParamUtil\";\r\n\r\nconst store = useStore();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\n\r\n/* 갤러리 수정정보 */\r\nconst updateForm = ref({\r\n  categoryId: '', /* 카테고리 번호 */\r\n  boardTitle: '', /* 게시글 제목 */\r\n  boardContent: '', /* 게시글 내용 */\r\n})\r\n/* 유효성검증 에러메시지 */\r\nconst errorFields = ref({\r\n  categoryId: '', /* 카테고리 번호*/\r\n  boardTitle: '', /* 게시글 제목 */\r\n  boardContent: '', /* 게시글 내용 */\r\n  saveFiles: '', /* 첨부파일 */\r\n})\r\n\r\nconst gallery = ref({}); // 해당게시글\r\nconst categoryList = ref([]); // 카테고리 목록\r\nconst fileList = ref([]); // 첨부파일 목록\r\nconst condition = ref({}); // 검색조건\r\nconst deleteFiles = ref([]); // 삭제 파일 목록\r\nconst saveFiles = ref({}); /* 저장 파일 목록 */\r\n\r\ninitGalleryUpdate();\r\n\r\n/**\r\n * 갤러리 수정 컴포넌트를 초기화합니다.\r\n */\r\nasync function initGalleryUpdate() {\r\n  condition.value = createCondition(route.query, 3);\r\n\r\n  try {\r\n    const boardId = route.params.boardId;\r\n    const [galleryResult, categoryResult] =await Promise.all([\r\n      getGalleryDetail(boardId),\r\n      getCategoryList(GALLERY_CATEGORY_ID)\r\n    ])\r\n\r\n    gallery.value = galleryResult.gallery;\r\n    fileList.value = galleryResult.fileList;\r\n    categoryList.value = categoryResult;\r\n\r\n    initFormValue(updateForm.value, gallery.value);\r\n  } catch ({message}) {\r\n    console.error(message);\r\n  }\r\n}\r\n\r\n/**\r\n * 갤러리를 수정합니다.\r\n */\r\nasync function onUpdate() {\r\n  if (!validateUpdateForm() && !isCurrentUserId(gallery.value.userId)) {\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const formData = createFormData(updateForm.value, saveFiles.value, deleteFiles.value);\r\n\r\n    const boardId = await updateGallery(route.params.boardId, formData);\r\n\r\n    store.commit('boardFileStore/clearFile');\r\n\r\n    router.push({path: `/galleries/${boardId}`, query: condition.value});\r\n\r\n  } catch ({data, message}) {\r\n    // 유효성검증에 실패한 필드의 에러메시지를 저장합니다.\r\n    for (const field in data) {\r\n      errorFields.value[field] = data[field];\r\n    }\r\n    console.error(message);\r\n  }\r\n}\r\n\r\n/**\r\n * 첨부파일의 삭제버튼을 클릭시 삭제목록에 추가합니다.\r\n *\r\n * @param fileId 삭제파일번호\r\n */\r\nfunction onDeleteFile(fileId) {\r\n  deleteFiles.value.push(fileId);\r\n  fileList.value = fileList.value.filter(e => e.fileId !== fileId);\r\n}\r\n\r\n/**\r\n * 수정폼을 검증합니다.\r\n * @returns {boolean}\r\n */\r\nfunction validateUpdateForm() {\r\n  errorFields.value.boardTitle = validateTitle(updateForm.value.boardTitle);\r\n  errorFields.value.boardContent = validateContent(updateForm.value.boardContent);\r\n  errorFields.value.categoryId = validateCategory(updateForm.value.categoryId);\r\n\r\n  for (const errorMsg of Object.values(errorFields.value)) {\r\n    if (errorMsg) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n/**\r\n * 파일 인풋 컴포넌트에서 전송된 파일들을 저장합니다.\r\n *\r\n * @param uploadFiles\r\n */\r\nfunction onUploadFile(uploadFiles) {\r\n  saveFiles.value = uploadFiles\r\n}\r\n\r\n</script>\r\n\r\n\r\n<script>\r\nexport default {\r\n  name: \"GalleryUpdate\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.update-category-container, .update-title-container,\r\n.update-content-container, .update-file-container {\r\n  border-bottom: 1px solid var(--border-color-gray);\r\n  height: 100%;\r\n  display: flex;\r\n}\r\n\r\n.update-category-input-container, .update-title-input-container,\r\n.update-content-input-container, .update-file-input-container {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  margin: 5px 0 5px 10px;\r\n}\r\n\r\n.update-category {\r\n  width: 200px;\r\n}\r\n\r\n.update-title {\r\n  width: 95%;\r\n  height: 40px;\r\n}\r\n\r\n.update-content {\r\n  width: 95%;\r\n  min-height: 200px;\r\n}\r\n\r\n</style>","import script from \"./GalleryUpdate.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./GalleryUpdate.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./GalleryUpdate.vue?vue&type=style&index=0&id=023dc5a0&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-023dc5a0\"]])\n\nexport default __exports__"],"names":["registerGallery","formData","axios","post","MULTIPART_CONFIG","then","data","catch","response","errorFields","errorMessage","message","getGalleryList","condition","get","params","getGalleryDetail","boardId","updateGallery","put","deleteGallery","delete","__default__","name","store","useStore","route","useRoute","router","useRouter","updateForm","ref","categoryId","boardTitle","boardContent","saveFiles","gallery","categoryList","fileList","deleteFiles","async","initGalleryUpdate","value","createCondition","query","galleryResult","categoryResult","Promise","all","getCategoryList","GALLERY_CATEGORY_ID","initFormValue","console","error","onUpdate","validateUpdateForm","isCurrentUserId","userId","createFormData","commit","push","path","field","onDeleteFile","fileId","filter","e","validateTitle","validateContent","validateCategory","errorMsg","Object","values","onUploadFile","uploadFiles","__exports__"],"sourceRoot":""}