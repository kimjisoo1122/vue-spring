{"version":3,"file":"js/443.22162715.js","mappings":"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","sources":["webpack://frontend/./src/api/board/freeService.js","webpack://frontend/./src/api/fileService.js","webpack://frontend/./src/util/boardUtil.js","webpack://frontend/./src/views/board/free/FreeUpdate.vue","webpack://frontend/./src/views/board/free/FreeUpdate.vue?45b1"],"sourcesContent":["import axios from \"@/api/config/axios\";\r\nimport {MULTIPART_CONFIG} from \"@/constants\";\r\n\r\n/**\r\n * 자유게시글을 등록합니다.\r\n * @param formData 등록 폼\r\n * @returns {Promise<number>}\r\n * 등록된 게시글 번호를 반환하거나,\r\n * data: 에러필드에 에러메시지가 담겨진 객체를 반환합니다.\r\n * message: API 통신 에러메시지\r\n */\r\nexport function registerFree (formData) {\r\n  return axios.post('/api/frees', formData, MULTIPART_CONFIG)\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorFields, errorMessage}}}) => {\r\n        throw {\r\n          data: errorFields,\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 자유게시글 목록을 조회합니다.\r\n * @param condition 검색조건\r\n * @returns {Promise<Array>} 자유게시글 목록을 배열로 반환합니다.\r\n */\r\nexport function getFreeList(condition) {\r\n  return axios.get('/api/frees', {\r\n    params: condition\r\n  })\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 자유게시글 상세정보를 조회합니다.\r\n * @param boardId 자유게시글 번호\r\n * @returns {Promise<Object>} 자유게시글 상세정보\r\n */\r\nexport function getFreeDetail(boardId) {\r\n  return axios.get(`/api/frees/${boardId}`)\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 자유게시글을 업데이트합니다.\r\n * @param boardId 자유게시글 번호\r\n * @param formData 업데이트 폼\r\n * @return {Promise<number>} 자유게시글 번호\r\n */\r\nexport function updateFree(boardId, formData) {\r\n  return axios.put(`/api/frees/${boardId}`, formData, MULTIPART_CONFIG)\r\n      .then(() => {\r\n        return boardId;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 자유게시글을 삭제합니다.\r\n * @param boardId 자유게시글 번호\r\n * @return {Promise<void>}\r\n */\r\nexport function deleteFree(boardId) {\r\n  return axios.delete(`/api/frees/${boardId}`)\r\n      .then(() => {\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        };\r\n      });\r\n}","import axios from \"@/api/config/axios\";\r\n\r\n/**\r\n * 게시글에 첨부된 파일목록을 조회합니다.\r\n * @param boardId 게시글 번호\r\n * @return {Promise<Array>} 첨부된 파일목록을 배열로 반환합니다.\r\n */\r\nexport function getBoardFileList(boardId) {\r\n  return axios.get(`/api/file/board/${boardId}`)\r\n      .then(({data: {data}}) => {\r\n        return data;\r\n      })\r\n      .catch(({response: {data: {errorMessage}}}) => {\r\n        throw {\r\n          message: errorMessage\r\n        }\r\n      });\r\n}\r\n\r\n/**\r\n * 파일을 다운로드합니다.\r\n * @param fileId 파일번호\r\n */\r\nexport const fileDown = (fileId) => {\r\n  return axios({\r\n    url: `/api/file/${fileId}`,\r\n    method: 'GET',\r\n    responseType: 'blob',  // 바이너리데이터를 받을수있는 브라우저전용 데이터타입\r\n  })\r\n      .then((response) => {\r\n        const url = window.URL.createObjectURL(new Blob([response.data]))\r\n        const link = document.createElement('a')\r\n        link.href = url\r\n        link.download = extractDownloadFilename(response);\r\n\r\n        document.body.appendChild(link)\r\n        link.click();\r\n        link.remove();\r\n\r\n        window.URL.revokeObjectURL(url);\r\n      })\r\n      .catch(error => {\r\n        if (error.response.data) {\r\n          const reader = new FileReader();\r\n          reader.onload = function() {\r\n            const errorData = JSON.parse(reader.result);\r\n            console.error(errorData.errorMessage);\r\n            alert(errorData.errorMessage);\r\n          };\r\n          reader.readAsText(error.response.data);\r\n        }\r\n      })\r\n};\r\n\r\n/**\r\n * 다운로드 파일이름을 추출합니다.\r\n * @param response 서버 응답데이터\r\n * @returns {string} 다운로드 파일이름을 반환합니다.\r\n */\r\nfunction extractDownloadFilename(response) {\r\n  const disposition = response.headers[\"content-disposition\"];\r\n  return decodeURI(\r\n      disposition\r\n          .match(/filename[^;=\\n]*=((['\"]).*?\\2|[^;\\n]*)/)[1]\r\n          .replace(/['\"]/g, \"\")\r\n  );\r\n}","/**\r\n * 수정폼에서 조회한 게시글의 정보를 폼에 입력합니다.\r\n * @param form 수정 폼\r\n * @param board 게시글 정보\r\n */\r\nexport function initFormValue(form, board) {\r\n  for (const field in form) {\r\n    form[field] = board[field];\r\n  }\r\n}","<template>\r\n\r\n  <GNB></GNB>\r\n\r\n  <!-- 타이틀 -->\r\n  <board-title title=\"자유게시판\"></board-title>\r\n\r\n\r\n  <div class=\"update-container\">\r\n\r\n    <!-- 게시글 카테고리 -->\r\n    <div class=\"update-category-container\">\r\n\r\n      <board-form-title name=\"분류\" class=\"board-form-title-category\"></board-form-title>\r\n\r\n      <div class=\"update-category-input-container\">\r\n        <category-select\r\n            v-model=\"updateForm.categoryId\"\r\n            @change=\"errorFields.categoryId = validateCategory(updateForm.categoryId)\"\r\n            :category-list=\"categoryList\"\r\n            class=\"update-category\">\r\n        </category-select>\r\n        <input-error :error-msg=\"errorFields.categoryId\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 게시글 제목 -->\r\n    <div class=\"update-title-container\">\r\n\r\n      <board-form-title name=\"제목\" class=\"board-form-title-title\"></board-form-title>\r\n\r\n      <div class=\"update-title-input-container\">\r\n        <base-input\r\n            v-model=\"updateForm.boardTitle\"\r\n            @change=\"errorFields.boardTitle = validateTitle(updateForm.boardTitle)\"\r\n            placeholder=\"제목을 입력해 주세요.\"\r\n            class=\"update-title\">\r\n        </base-input>\r\n        <input-error :error-msg=\"errorFields.boardTitle\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 게시글 내용 -->\r\n    <div class=\"update-content-container\">\r\n\r\n      <board-form-title name=\"내용\" class=\"board-form-title-content\"></board-form-title>\r\n\r\n      <div class=\"update-content-input-container\">\r\n        <base-textarea\r\n            v-model=\"updateForm.boardContent\"\r\n            @change=\"errorFields.boardContent = validateTitle(updateForm.boardContent)\"\r\n            class=\"update-content\">\r\n        </base-textarea>\r\n        <input-error :error-msg=\"errorFields.boardContent\"></input-error>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 첨부파일 -->\r\n    <div class=\"update-file-container\">\r\n      <board-form-title\r\n          :required=\"false\"\r\n          name=\"첨부\"\r\n          class=\"board-form-title-file\">\r\n      </board-form-title>\r\n\r\n      <div class=\"update-file-input-container\">\r\n        <board-file-list\r\n            @delete-file=\"onDeleteFile\"\r\n            :is-update=\"true\"\r\n            :file-list=\"fileList\"></board-file-list>\r\n        <input-error :error-msg=\"errorFields.saveFiles\"></input-error>\r\n      </div>\r\n\r\n    </div>\r\n\r\n    <!-- 수정 폼 버튼 -->\r\n    <board-form-btn-container\r\n        @update=\"onUpdate\"\r\n        @cancel=\"onCancel\"\r\n        form-type=\"update\">\r\n    </board-form-btn-container>\r\n\r\n  </div>\r\n\r\n</template>\r\n\r\n<script setup>\r\n/**\r\n * 자유게시글 수정 폼 컴포넌트\r\n */\r\nimport BoardTitle from \"@/components/board/BoardTitle.vue\";\r\nimport BoardFormTitle from \"@/components/board/BoardFormTitle.vue\";\r\nimport {ref} from \"vue\";\r\nimport CategorySelect from \"@/components/CategorySelect.vue\";\r\nimport InputError from \"@/components/base/BaseInputError.vue\";\r\nimport BaseInput from \"@/components/base/BaseInput.vue\";\r\nimport {validateCategory, validateContent, validateTitle} from \"@/util/boardValidUtil\";\r\nimport BaseTextarea from \"@/components/base/BaseTextarea.vue\";\r\nimport BoardFileList from \"@/components/board/BoardFileList.vue\";\r\nimport {getBoardFileList} from \"@/api/fileService\";\r\nimport {useRoute, useRouter} from \"vue-router\";\r\nimport {getFreeDetail, updateFree} from \"@/api/board/freeService\";\r\nimport {FREE_CATEGORY_ID} from \"@/constants\";\r\nimport {getCategoryList} from \"@/api/categoryService\";\r\nimport {useStore} from \"vuex\";\r\nimport {isCurrentUserId} from \"@/util/authUtil\";\r\nimport GNB from \"@/components/GNB.vue\";\r\nimport BoardFormBtnContainer from \"@/components/board/BoardFormBtnContainer.vue\";\r\nimport {initFormValue} from \"@/util/boardUtil\";\r\nimport {createCondition} from \"@/util/queryParamUtil\";\r\n\r\nconst store = useStore();\r\nconst route = useRoute();\r\nconst router = useRouter();\r\n\r\n/* 자유게시글 수정정보 */\r\nconst updateForm = ref({\r\n  categoryId: '', /* 카테고리 번호 */\r\n  boardTitle: '', /* 게시글 제목 */\r\n  boardContent: '', /* 게시글 내용 */\r\n})\r\n/* 유효성검증 에러메시지 */\r\nconst errorFields = ref({\r\n  categoryId: '', /* 카테고리 번호 */\r\n  boardTitle: '', /* 게시글 제목 */\r\n  boardContent: '', /* 게시글 내용 */\r\n  saveFiles: '', /* 첨부파일 */\r\n})\r\n\r\nconst free = ref({}); // 해당 자유게시글\r\nconst categoryList = ref([]); // 카테고리 목록\r\nconst condition = ref({}); // 검색조건\r\nconst fileList = ref([]); // 첨부 파일 목록\r\nconst deleteFiles = ref([]); // 삭제 파일 목록\r\n\r\ninitFreeUpdate();\r\n\r\n/**\r\n * 자유게시글 수정 컴포넌트를 초기화합니다.\r\n */\r\nasync function initFreeUpdate() {\r\n  condition.value = createCondition(route.query);\r\n\r\n  try {\r\n    const boardId = route.params.boardId;\r\n\r\n    const [fileListResult, freeResult, categoryResult] =await Promise.all([\r\n      getBoardFileList(boardId),\r\n      getFreeDetail(boardId),\r\n      getCategoryList(FREE_CATEGORY_ID)\r\n    ])\r\n\r\n    fileList.value = fileListResult;\r\n    free.value = freeResult;\r\n    categoryList.value = categoryResult;\r\n\r\n    initFormValue(updateForm.value, free.value);\r\n  } catch ({message}) {\r\n    console.error(message);\r\n  }\r\n}\r\n\r\n/**\r\n * 자유게시글을 수정합니다.\r\n */\r\nasync function onUpdate() {\r\n    if (!validateUpdateForm() && !isCurrentUserId(free.value.userId)) {\r\n      return false;\r\n    }\r\n\r\n    try {\r\n      const formData = createFormData();\r\n\r\n      const boardId = await updateFree(route.params.boardId, formData);\r\n\r\n      store.commit('boardFileStore/clearFile');\r\n\r\n      router.push({path: `/frees/${boardId}`, query: condition.value});\r\n\r\n    } catch ({data, message}) {\r\n      // 유효성검증에 실패한 필드의 에러메시지를 저장합니다.\r\n      for (const field in data) {\r\n        errorFields.value[field] = data[field];\r\n      }\r\n      console.error(message);\r\n    }\r\n}\r\n\r\n/**\r\n * 첨부파일의 삭제버튼을 클릭시 삭제목록에 추가합니다.\r\n *\r\n * @param fileId 삭제파일번호\r\n */\r\nfunction onDeleteFile(fileId) {\r\n  deleteFiles.value.push(fileId);\r\n  fileList.value = fileList.value.filter(e => e.fileId !== fileId);\r\n}\r\n\r\n/* 수정을 취소합니다. */\r\nfunction onCancel() {\r\n  router.push({path: '/frees', query: condition.value});\r\n}\r\n\r\n/**\r\n * FormData를 생성합니다\r\n * @returns FormData 게시글form정보\r\n */\r\nfunction createFormData() {\r\n  const formData = new FormData();\r\n\r\n  for (const field in updateForm.value) {\r\n    formData.append(field, updateForm.value[field]);\r\n  }\r\n\r\n  /* 첨부파일 추가 */\r\n  store.getters['boardFileStore/getSaveFiles']\r\n      .forEach(file => {\r\n        formData.append('saveFiles', file);\r\n      })\r\n\r\n  /* 삭제파일 추가 */\r\n  for (const deleteFileId of deleteFiles.value) {\r\n    formData.append('deleteFiles', deleteFileId);\r\n  }\r\n\r\n  return formData;\r\n}\r\n\r\n/**\r\n * 수정폼을 검증합니다.\r\n * @returns {boolean}\r\n */\r\nfunction validateUpdateForm() {\r\n  errorFields.value.boardTitle = validateTitle(updateForm.value.boardTitle);\r\n  errorFields.value.boardContent = validateContent(updateForm.value.boardContent);\r\n  errorFields.value.categoryId = validateCategory(updateForm.value.categoryId);\r\n\r\n  for (const errorMsg of Object.values(errorFields.value)) {\r\n    if (errorMsg) {\r\n      console.log(errorMsg);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\n</script>\r\n\r\n\r\n<script>\r\nexport default {\r\n  name: \"FreeUpdate\"\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n.update-category-container, .update-title-container,\r\n.update-content-container, .update-file-container {\r\n  border-bottom: 1px solid var(--border-color-gray);\r\n  height: 100%;\r\n  display: flex;\r\n}\r\n\r\n.update-category-input-container, .update-title-input-container,\r\n.update-content-input-container, .update-file-input-container {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  margin: 5px 0 5px 10px;\r\n}\r\n\r\n.update-category-container {\r\n  border-top: 1px solid var(--border-color-gray);\r\n}\r\n\r\n.update-category {\r\n  width: 200px;\r\n}\r\n\r\n.update-title {\r\n  width: 95%;\r\n  height: 40px;\r\n}\r\n\r\n.update-content {\r\n  width: 95%;\r\n  min-height: 200px;\r\n}\r\n\r\n</style>","import script from \"./FreeUpdate.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./FreeUpdate.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./FreeUpdate.vue?vue&type=style&index=0&id=4c8e441e&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4c8e441e\"]])\n\nexport default __exports__"],"names":["registerFree","formData","axios","post","MULTIPART_CONFIG","then","data","catch","response","errorFields","errorMessage","message","getFreeList","condition","get","params","getFreeDetail","boardId","updateFree","put","deleteFree","delete","getBoardFileList","initFormValue","form","board","field","__default__","name","store","useStore","route","useRoute","router","useRouter","updateForm","ref","categoryId","boardTitle","boardContent","saveFiles","free","categoryList","fileList","deleteFiles","async","initFreeUpdate","value","createCondition","query","fileListResult","freeResult","categoryResult","Promise","all","getCategoryList","FREE_CATEGORY_ID","console","error","onUpdate","validateUpdateForm","isCurrentUserId","userId","createFormData","commit","push","path","onDeleteFile","fileId","filter","e","onCancel","FormData","append","getters","forEach","file","deleteFileId","validateTitle","validateContent","validateCategory","errorMsg","Object","values","log","__exports__"],"sourceRoot":""}