<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.study.mapper.NoticeBoardMapper">

    <!-- 공지사항을 등록합니다. -->
    <insert id="insertNotice"
            parameterType="noticeBoardDto"
            useGeneratedKeys="true"
            keyProperty="noticeId">
        INSERT INTO notice_board
            (category_id,
             notice_writer,
             notice_title,
             notice_content)
        VALUES
            (#{categoryId},
             #{noticeWriter},
             #{noticeTitle},
             #{noticeContent})
    </insert>

    <!-- 공지사항을 조회합니다. -->
    <select id="selectNoticeById"
            parameterType="long"
            resultType="noticeBoardDto">
        SELECT n.notice_id,
               n.notice_writer,
               n.notice_title,
               n.notice_content,
               n.notice_view_cnt,
               n.create_date,
               n.update_date,
               c.category_name
        FROM notice_board n
            JOIN category c ON c.category_id = n.category_id
        WHERE notice_id = #{noticeId}
    </select>

    <!-- 공지사항을 수정합니다. -->
    <update id="updateNotice"
            parameterType="noticeBoardDto">
        UPDATE notice_board
        <set>
            <if test="categoryId != null">
                category_id = #{categoryId},
            </if>
            <if test="noticeWriter != null &amp;&amp; noticeWriter != ''">
                notice_writer = #{noticeWriter},
            </if>
            <if test="noticeTitle != null &amp;&amp; noticeTitle != ''">
                notice_title = #{noticeTitle},
            </if>
            <if test="noticeContent != null &amp;&amp; noticeContent != ''">
                notice_content = #{noticeContent},
            </if>
            update_date = NOW()
        </set>
        WHERE notice_id = #{noticeId}
    </update>

    <!-- 공지사항을 삭제합니다. -->
    <delete id="deleteNotice"
            parameterType="long">
        DELETE FROM notice_board
        WHERE notice_id = #{noticeId}
    </delete>

</mapper>