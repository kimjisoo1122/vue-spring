<!DOCTYPE html>
<html
  lang="ko"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{common/layout.html}">

  <head>
    <meta charset="UTF-8">
    <title th:text="${form.boardType.getTitle()}"></title>
    <link rel="stylesheet" th:href="@{/css/board/boardForm.css}">
    <script th:src="@{/js/board/boardForm.js}"></script>
  </head>

  <body>

    <header layout:fragment="header">
      <!-- 타이틀 -->
      <h1 th:text="${form.boardType.getTitle()}" class="form-header-title"></h1>
    </header>

    <main layout:fragment="main">

      <div class="form-main-container">

        <form th:method="post"
              th:enctype="${form.getEncType()}"
              th:object="${form}"
              data-th-formTypeValue="${form.getFormType().getValue()}"
              data-th-boardType="${form.getBoardType()}"
              onsubmit="return validateForm(this.getAttribute('formTypeValue'), this.getAttribute('boardType'))"
              class="board-form">

          <div class="form-main-type-container">
            <!-- 카테고리 -->
            <div class="form-type-name">
              분류
              <span class="from-required-star">*</span>
            </div>
            <div class="form-category-input-container">
              <select th:field="*{categoryId}" class="form-category-select">
                <option th:each="category : ${form.getCategoryList()}"
                        th:value="${category.categoryId}"
                        th:text="${category.categoryName}">
                </option>
              </select>
              <span th:errors="*{categoryId}" class="field-error"></span>
            </div>
          </div>

          <!-- 제목 -->
          <div class="form-main-title-container">
            <div class="form-title-name">
              제목
              <span class="from-required-star">*</span>
            </div>
            <div class="form-title-input-container">
              <input th:field="*{boardTitle}"
                     th:errorclass="input-error"
                     onchange="validateTitle()"
                     type="text" class="form-title-input">
              <span class="form-title-error field-error"></span>
              <span th:errors="*{boardTitle}" class="form-title-error field-error"></span>
            </div>

          </div>

          <!-- 내용 -->
          <div class="form-main-content-container">
            <div class="form-content-name">
              내용
              <span class="from-required-star">*</span>
            </div>
            <div class="form-content-input-container">
              <textarea th:field="*{boardContent}"
                        th:errorclass="input-error"
                        onchange="validateContent()"
                        class="form-content-textarea" ></textarea>
              <span class="form-content-error field-error"></span>
              <span th:errors="*{boardContent}" class="field-error"></span>
            </div>
          </div>

          <!-- 첨부파일 -->
          <div th:if="${form.hasFileInput()}" class="form-main-file-container">
            <div class="form-file-name">
              첨부
            </div>
            <div class="form-file-input-container">
              <p class="form-file-notice">jpg, gif, png, zip파일만 파일사이즈 2MB까지 업로드 가능합니다.</p>

              <!-- 파일등록 폼 -->
              <div th:if="${form.getFormType().name() == 'REGISTER'}"
                   th:each="idx : ${#numbers.sequence(1, 5)}"
                   class="form-file-input-box">
                <label th:for="${idx}" class="form-file-label"></label>
                <input data-th-idx="${idx}"
                       th:id="${idx}"
                       type="file"
                       value="test.jpg"
                       name="saveFiles"
                       onchange="validateFile(this.getAttribute('idx'))"
                       class="form-file-input">
              </div>

              <!-- 파일수정 폼 -->
              <th:block th:if="${form.getFormType().name() == 'UPDATE'}"
                        th:with="fileInputSize=${5 - form.getFileList().size()}">

                <!-- 등록된 파일목록 -->
                <div th:each="file : ${form.getFileList()}"
                     class="form-file-input-box">
                  <a th:href="|/file/${file.getFileId()}|"
                     th:text="${file.getFileOrgName()}"
                     class="form-file-down-link">
                  </a>
                  <button data-th-fileId="${file.getFileId()}"
                          type="button"
                          class="form-file-down-btn"
                          onclick="hideFile(this)"> X </button>
                </div>

                <!-- 첨부파일 인풋 -->
                <div class="form-file-input-box-container">
                  <div th:each="idx : ${#numbers.sequence(1, fileInputSize)}"
                       class="form-file-input-box">
                    <label th:for="${idx}" class="form-file-label"></label>
                    <input data-th-idx="${idx}"
                           th:id="${idx}"
                           type="file"
                           value="test.jpg"
                           name="saveFiles"
                           onchange="validateFile(this.getAttribute('idx'))"
                           class="form-file-input">
                  </div>
                </div>

              </th:block>

              <!-- 파일에러 -->
              <span class="form-file-error field-error"></span>

            </div>
          </div>

          <!-- 알림글 체크 -->
          <div th:if="${form.hasAlarmInput()}"
               class="form-main-alarm-container">
            <div class="form-alarm-name">
              알림글
            </div>
            <div class="form-alarm-input-container">
              <input th:field="*{checkAlarm}" type="checkbox" class="form-alarm-check">
            </div>
          </div>

          <!-- 게시글 타입설정 -->
          <div class="form-hidden-container">
            <input type="hidden" name="boardType" th:value="${form.getBoardType()}">
            <input type="hidden" name="formType" th:value="${form.getFormType()}">
          </div>

          <!-- 폼 버튼 -->
          <div class="form-main-btn-container">
            <!-- 등록/수정 -->
            <button th:text="${form.getFormType().getValue()}"
                    type="submit"
                    class="form-btn-submit">
            </button>

            <!-- 목록 -->
            <a th:href="|/admin/${form.boardType.getValue()}${condition.getQueryParam()}|">
              <button type="button" class="form-btn-list">목록</button>
            </a>

            <!-- 삭제 -->
            <button th:if="${form.hasDeleteBtn()}"
                    data-th-action="|${#httpServletRequest.getRequestURI()}/delete/${condition.getQueryParam()}|"
                    onclick="deleteBoard(this.getAttribute('action'))"
                    type="button"
                    class="form-btn-delete">
              삭제
            </button>
          </div>

        </form>

      </div>

    </main>

  </body>

</html>